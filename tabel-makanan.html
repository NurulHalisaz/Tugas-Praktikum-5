<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Daftar Makanan Khas Sulawesi Selatan</title>
 <link rel="stylesheet" href="style-makanan.css">
</head>
<body>
 <header> Makanan Khas </header>
 <div class="container">
 <aside class="sidebar">
 <nav>
 <ul>
 <li><a href="index.php">Dashboard</a></li>
 <li><a href="tabel-makanan.html">Makanan Khas</a></li>
 <li><a href="logout.php">Keluar</a></li>

 </ul>
 </nav>
 </aside>

 <section class="content">
 <h1>Daftar Makanan Khas Sulawesi Selatan</h1>
 <form id="food-form">
 <h2>Tambah Makanan Khas</h2>
 <label for="food-name">Nama Makanan:</label>
 <input type="text" id="food-name" name="food-name" placeholder="Masukkan nama makanan...">
 <label for="food-desc">Deskripsi Makanan:</label>
 <input type="text" id="food-desc" name="food-desc" placeholder="Masukkan deskripsi makanan...">
 <label for="food-image">Gambar Makanan:</label>
 <input type="file" id="food-image" name="food-image">

 <div class="add-button">
 <button type="submit" id="submit-btn">Tambah</button>
 </div>
 </form>
 <table id="food-table">
 <thead>
 <tr>
 <th>No</th>
 <th>Nama Makanan</th>
 <th>Gambar</th>
 <th>Deskripsi</th>
 <th>Aksi</th>
 </tr>
 </thead>
 <tbody>
 <tr>
 <td>1</td>
 <td>Coto Makassar</td>
 <td><img src="coto-makassar.jpeg" alt="Coto Makassar"width="100"></td>
 <td>Hidangan sup tradisional khas Makassar, terbuat dari daging sapi dan rempah khas.</td>
 <td>
 <button class="edit-btn"onclick="editRow(this)">Edit</button>
 <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
 </td>
 </tr>
 <tr>
 <td>2</td>
 <td>Pallubasa</td>
 <td><img src="pallubasa.jpeg" alt="Pallubasa" width="100"></td>
 <td>Makanan khas Makassar, mirip dengan Coto Makassar namun dengan tambahan kelapa parut.</td>
 <td>
<button class="edit-btn">Edit</button>
 <button class="delete-btn">Hapus</button>
 </td>
 </tr>
 <tr>
 <td>3</td>
 <td>Pisang Ijo</td>
 <td><img src="pisang-ijo.jpeg" alt="Pisang Ijo" width="100"></td>
 <td>Hidangan penutup berbahan dasar pisang yang dibalut dengan adonan tepung berwarna hijau.</td>
 <td>
 <button class="edit-btn">Edit</button>
 <button class="delete-btn">Hapus</button>
 </td>
 </tr>
 </tbody>
 </table>
 </section>
 </div>
 <script>
 //variabel menyimpan referensi baris
 let editingRow = null;
 // Mengakses elemen
 const foodForm = document.getElementById('food-form');
 const foodTable = document.getElementById('foodtable').getElementsByTagName('tbody')[0];
 foodForm.addEventListener('submit', function(e){ 
e.preventDefault();
 // Mengambil nilai input
 const foodName = document.getElementById('food-name').value;
 const foodDesc = document.getElementById('food-desc').value;
 const foodImage = document.getElementById('food-image').files[0];
if (!foodName || !foodDesc || !foodImage) {
    alert("Nama, Deskripsi, dan Gambar harus diisi!");
    return;
    }
 if(editingRow){
 setTimeout('editingRow = null;',100);
 } else {
 if (foodName && foodDesc && foodImage) {
 // Tambah data ke tabel
 const newRow = foodTable.insertRow();
 const cellNo = newRow.insertCell(0);
 const cellName = newRow.insertCell(1);
 const cellImage = newRow.insertCell(2);
 const cellDesc = newRow.insertCell(3);
 const cellAction = newRow.insertCell(4);
 // Set isi cell
 cellNo.textContent = foodTable.rows.length;
 cellName.textContent = foodName;
 // Baca gambar yang diunggah
 const reader = new FileReader();
 reader.onload = function(e){
 cellImage.innerHTML = `<img src="${e.target.result}" alt="${foodName}" width="100">`;
 };
 reader.readAsDataURL(foodImage);
 cellDesc.textContent = foodDesc;
 cellAction.innerHTML = `
 <button class="edit-btn" onclick="editRow(this)">Edit</button>
 <button class="delete-btn" onclick="deleteRow(this)">Hapus</button>
 `;
 //kosongkan input form
 foodForm.reset();
 
 } else{
 alert("Nama, deskripsi dan gambar harus diisi.");
 }
 }
 });

 // Fungsi hapus
 function deleteRow(button){
if(!confirm("apakah ingin dihapus datanya?"))return;
 const row = button.parentElement.parentElement;
 row.parentElement.removeChild(row);
 //update nomor baris
 const rows = document.getElementById("food-table").getElementsByTagName("tbody")[0].rows;
 for (let i = 0; i < rows.length; i++) {
 rows[i].cells[0].textContent = i+1;
 }
}
 function editRow(button){
 const row = button.parentElement.parentElement;
 document.getElementById('food-name').value = row.cells[1].textContent;
 document.getElementById('food-desc').value = row.cells[3].textContent;
 editingRow = row;
 submitBtn.textContent = "Simpan"
 }

 </script> 
</body>
</html>